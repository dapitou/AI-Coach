# AI 识别_动作纠错交互

## 目录
- [AI 识别\_动作纠错交互](#ai-识别_动作纠错交互)
  - [目录](#目录)
  - [交互定义通用规范](#交互定义通用规范)
    - [核心元素](#核心元素)
    - [元素样式](#元素样式)
    - [元素类型](#元素类型)
    - [逻辑与动效通用定义（新增）](#逻辑与动效通用定义新增)
      - [1. 纠错模式](#1-纠错模式)
      - [2. 优先级](#2-优先级)
      - [3. 动效参数](#3-动效参数)
      - [4. 触发时机](#4-触发时机)
  - [抬肘高度不足](#抬肘高度不足)
  - [小臂不垂直](#小臂不垂直)
  - [抬膝高度不足](#抬膝高度不足)
  - [耸肩（通用）](#耸肩通用)
  - [膝内扣（深蹲）](#膝内扣深蹲)
  - [下蹲幅度不足（深蹲）](#下蹲幅度不足深蹲)
  - [膝内扣（弓步）](#膝内扣弓步)
  - [下蹲幅度不足（弓步）](#下蹲幅度不足弓步)
  - [弓背（通用）](#弓背通用)
  - [重心侧倾（通用）](#重心侧倾通用)

## 交互定义通用规范
本框架采用 **“实际-理想”** 差分模型，通过视觉引导将 [实际状态] 修正至 [理想状态]。

### 核心元素
1. **关键点/线** [实际状态]：用户当前的动作。
2. **目标点/线** [理想状态]：基于生物力学计算的正确位置/形态。
3. **引导**：连接关键与目标，指示修正方向的动态符号。

### 元素样式
- **点**
  - `实心圆`：关键点
  - `空心圆`：目标点
- **线**
  - `实线`：关键线
  - `虚线`：目标线
- **指引**
  - `箭头`：纠错引导
  - `对勾`：正确确认

### 元素类型
- **线**：
  - `矢量`：有明确方向，关注角度。
  - `连线`：两点连接，关注位置/长度。
  - `曲线`：多点拟合，关注形态/曲率。

### 逻辑与动效通用定义（新增）
#### 1. 纠错模式
- **实时跟随**：状态随每一帧判定实时切换（红<->绿）。适用于：角度类、位置类（如小臂垂直）。
- **结果锁定**：单次动作中一旦触发错误，全程判负并保持红色，直到下一次动作开始。适用于：严判类（如耸肩）。
- **记忆修正**：触发错误后变红，若用户在当前动作内修正成功，则变绿并记录为“有效修正”。适用于：教学类（如膝内扣）。

#### 2. 优先级
- **P0**：阻断级。触发时隐藏其他低优先级纠错，独占显示。
- **P1**：警示级。可与其他P1共存，或按时间轮播。

#### 3. 动效参数
- **弹跳**：引导箭头沿指示方向往复运动。标准频率：2Hz (120BPM)。
- **呼吸**：透明度或大小周期性变化。标准频率：1Hz (60BPM)。
- **缓动**：颜色/位置变化的过渡时间。标准：0.2s (Out-Cubic)。

#### 4. 触发时机
- **全程**：动作全周期检测。
- **发力区**：仅在向心阶段（如推起、蹲起）检测。
- **抗阻区**：仅在离心阶段（如其下放、下蹲）检测。
- **极值点**：仅在动作顶点或底端检测。

## 抬肘高度不足
> 描述：动作顶峰，肘未接近肩高
- **关键点**：
  - 坐标：肘
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：目标线上端点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：肩
  - 方向：肩 → 肘（大臂）
  - 终点：肘
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：肩
  - 方向：水平 ← →
  - 终点：大臂实时等长点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：-
  - 终点：肘
  - 方向：竖直向上 ↑ 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导小臂垂直
  - 动画：箭头呼吸 (Pulse, 1Hz)
  - 显隐：1s渐显渐隐
- **提示**：“肘部抬至与肩等高效果更好！”
- **逻辑**：
  - 检测时机：极值点
  - 判定阈值：偏离肩部水平轴 ＞15°
  - 防抖策略：连续3帧
- **纠错机制**：实时跟随

（宽松 ＜ 20°；标准 ＜15°；严格 ＜ 10°）

## 小臂不垂直
> 描述：一个动作循环内，任意一侧小臂不垂直于地面
- **关键点**：
  - 坐标：腕
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：目标线上端点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：肘
  - 方向：肘 → 腕（小臂）
  - 终点：腕
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：肘
  - 方向：竖直向上 ↑
  - 终点：小臂实时等长点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：肘
  - 终点：-
  - 方向：水平 ← → 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导小臂垂直
- **提示词**：“小臂全程垂直于地面效果更好！”
- **【算法逻辑】**：
  - **检测时机**：发力区 (Concentric) + 抗阻区 (Eccentric)（即动作全过程，排除准备态）
  - **判定阈值**：偏离竖直轴 > 20°
  - **防抖策略**：连续 3 帧触发
- **【交互机制】**：
  - **纠错模式**：实时跟随 (Real-time)
  - **优先级**：P1
- **【动效细节】**：
  - **动态行为**：箭头弹跳 (Bounce, 2Hz)
  - **消失机制**：动作状态切换至 Idle 时立即消失

## 抬膝高度不足
> 描述：动作顶峰，膝未接近髋高
- **关键点**：
  - 坐标：膝
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：-
- **关键线**：
  - 起点：髋
  - 方向：髋 → 膝（大腿）
  - 终点：膝
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：髋中点（作为目标线中点）
  - 方向：水平 ← →
  - 终点：-
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：膝
  - 终点：-
  - 方向：竖直向上 ↑ 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导膝抬高
- **提示词**：“膝抬至与髋等高效果更好！”
- **【算法逻辑】**：
  - **检测时机**：极值点 (Peak)
  - **判定阈值**：膝盖Y坐标 > 髋部Y坐标 + (0.1 × 大腿长)
  - **防抖策略**：连续 5 帧
- **【交互机制】**：
  - **纠错模式**：实时跟随 (Real-time)
  - **优先级**：P2
- **【动效细节】**：
  - **动态行为**：箭头弹跳 (Bounce, 2Hz)
  - **消失机制**：腿放下后立即消失

## 耸肩（通用）
> 描述：动作底峰vs初始，耳中点 / 肩中点垂直间距压缩太多
- **关键点**：-
- **目标点**：-
- **关键线**：-
- **目标线**：-
- **引导**：
  - 起点：-
  - 方向：垂直向下
  - 终点：双肩
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导肩部下压
- **提示词**：“全程保持肩部下压”
- **【算法逻辑】**：
  - **检测时机**：全程 (All)
  - **判定阈值**：(基准肩颈距 - 当前肩颈距) / 基准肩颈距 > 0.20 (压缩率 > 20%)
  - **防抖策略**：移动平均 (Alpha=0.6)
- **【交互机制】**：
  - **纠错模式**：结果锁定 (Latch)（一旦耸肩，本组动作即判负，强迫用户重置）
  - **优先级**：P0 (Blocker)
- **【动效细节】**：
  - **动态行为**：高频弹跳 (Bounce, 3Hz, 强调紧迫感)
  - **消失机制**：直到用户完全放松回到 Start 状态

## 膝内扣（深蹲）
> 描述：下蹲过程中，双膝水平间距显著小于双髋间距（内八字）
- **关键点**：
  - 坐标：膝
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：目标线上端点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：踝
  - 方向：踝 → 膝（小腿）
  - 终点：膝
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：踝/脚尖连线中点（足底中点） 
  - 方向：竖直向上 ↑
  - 终点：小腿实时等长点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：膝
  - 终点：-
  - 方向：水平 ← → 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导膝外展
- **提示词**：“膝与脚尖保持同向”
- **【算法逻辑】**：
  - **检测时机**：下蹲过程 (Down Stage)
  - **判定阈值**：`膝盖间距 / 髋部间距 < 1.2`
  - **防抖策略**：无 (依赖记忆修正机制)
- **【交互机制】**：
  - **纠错模式**：记忆修正 (Memory Fix)
    - *机制*：在深蹲底部 (Ratio < 0.3) 修正姿态后，即判定本轮合格。
  - **优先级**：P1 (安全类错误，高于幅度)
- **【动效细节】**：
  - **动态行为**：箭头向外静态指示
  - **消失机制**：修正后或动作结束后消失

## 下蹲幅度不足（深蹲）
> 描述：动作底峰，髋部未降至膝盖高度（大腿未平行地面）
- **关键点**：
  - 坐标：髋中点 (Hip Mid)
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：膝中点 (Knee Mid)
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：髋中点
  - 方向：髋 → 膝
  - 终点：膝中点
  - 样式：连线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：双膝连线中点
  - 方向：水平 ← →
  - 终点：-
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：髋中点
  - 终点：膝中点
  - 方向：竖直向下 ↓
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导下蹲幅度
- **提示词**：“蹲至大腿平行地面效果更好！”
- **【算法逻辑】**：
  - **检测时机**：下蹲过程 (Down Stage)
  - **判定阈值**：`(髋膝垂直距离 / 站立基准) > 0.15`
  - **防抖策略**：无 (依赖记忆修正机制)
- **【交互机制】**：
  - **纠错模式**：记忆修正 (Memory Fix)
    - *机制*：只要在下蹲过程中有一帧达标，即判定本轮合格。
  - **优先级**：P2 (效果类错误)
- **【动效细节】**：
  - **动态行为**：箭头呼吸 (Pulse, 1Hz)
  - **消失机制**：达标后或动作结束后消失

## 膝内扣（弓步）
> 描述：动作底峰，前膝-身体中轴（双髋中点）间距 / 髋-身体中轴间距比例太窄
- **关键点**：
  - 坐标：前膝
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：目标线上端点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：前踝
  - 方向：前踝 → 前膝（小腿）
  - 终点：前膝
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：前踝/前脚尖连线中点（前足底中点）
  - 方向：竖直向上 ↑
  - 终点：前小腿实时等长点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：前膝
  - 终点：-
  - 方向：水平 ← → 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导膝外展
- **提示词**：“膝与脚尖保持同向”
- **【算法逻辑】**：
  - **检测时机**：全程 (All)
  - **判定阈值**：膝宽 < 髋宽 * 1.1 (2D投影)
  - **防抖策略**：连续 3 帧
- **【交互机制】**：
  - **纠错模式**：实时跟随 (Real-time)
  - **优先级**：P1
- **【动效细节】**：
  - **动态行为**：箭头弹跳 (Bounce)
  - **消失机制**：实时

## 下蹲幅度不足（弓步）
> 描述：动作底峰vs站直，髋中点 / 前膝垂直间距太远
- **关键点**：
  - 坐标：髋中点
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：前膝水平线与髋中点垂线的交点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：-
- **目标线**：
  - 起点：目标点（作为目标线中点）
  - 方向：水平 ← →
  - 终点：-
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：髋中点
  - 终点：-
  - 方向：竖直向下 ↓ 指向目标点
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导下蹲幅度
- **提示词**：“蹲至前腿平行地面效果更好！”
- **【算法逻辑】**：
  - **检测时机**：极值点 (Bottom)
  - **判定阈值**：后膝离地高度 > (0.2 × 小腿长)
  - **防抖策略**：无
- **【交互机制】**：
  - **纠错模式**：记忆修正 (Memory Fix)
  - **优先级**：P2
- **【动效细节】**：
  - **动态行为**：向下箭头呼吸 (Pulse)
  - **消失机制**：站起后保留显示 1s

## 弓背（通用）
> 描述：动作底峰，肩-胸-背-髋不共线（向身体后侧凸起）
- **关键点**：
  - 坐标：脊柱最大后凸点（通常为胸/腰椎）
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：关键点在目标线上的垂足
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 路径：耳 → 肩 → 胸 → 腰 → 髋
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：颈部中点
  - 终点：髋中点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：关键点
  - 终点：目标点
  - 方向：垂直指向目标线 ⊥
  - 样式：箭头（错误）/ 对勾（正确），橙色（强调）
  - 功能：引导挺胸/顶腰
- **提示词**：“背部挺直，不要弓腰！”
- **【算法逻辑】**：
  - **检测时机**：全程 (All)（特别是下蹲过程）
  - **判定阈值**：脊柱曲率 > 0.05 (归一化弓背幅度)
  - **防抖策略**：阻尼平滑 (Damping)
- **【交互机制】**：
  - **纠错模式**：实时跟随 (Real-time)
  - **优先级**：P1
- **【动效细节】**：
  - **动态行为**：静态高亮 (Static Highlight) + 箭头指示
  - **消失机制**：实时

## 重心侧倾（通用）
> 描述：动作底峰，躯干重心（双肩双髋）偏离身体中轴（双脚中点垂线）
- **关键点**：
  - 坐标：肩中点
  - 样式：实心圆，红色（错误）/ 绿色（正确）
- **目标点**：
  - 坐标：目标线上端点
  - 样式：空心圆，红色（错误）/ 绿色（正确）
- **关键线**：
  - 起点：髋中点
  - 方向：髋中点 → 肩中点（躯干）
  - 终点：肩中点
  - 样式：实线，红色（错误）/ 绿色（正确）
- **目标线**：
  - 起点：髋中点
  - 方向：竖直向上
  - 终点：关键线（躯干）实时等长点
  - 样式：虚线，红色（错误）/ 绿色（正确）
- **引导**：
  - 起点：肩中点
  - 终点：-
  - 方向：水平 ← → 指向目标线
  - 样式：箭头（错误）/ 对勾（正确），红色（错误）/ 绿色（正确）
  - 功能：引导躯干保持中轴
- **提示词**：“请保持身体不要侧倾！”
- **【算法逻辑】**：
  - **检测时机**：全程 (All)
  - **判定阈值**：肩中点X坐标 偏离 髋中点X坐标 > 10% 躯干长度
  - **防抖策略**：连续 5 帧
- **【交互机制】**：
  - **纠错模式**：实时跟随 (Real-time)
  - **优先级**：P2
- **【动效细节】**：
  - **动态行为**：箭头弹跳 (Bounce)
  - **消失机制**：实时