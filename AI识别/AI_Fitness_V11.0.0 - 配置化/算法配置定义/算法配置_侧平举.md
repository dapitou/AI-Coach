<!-- d:\AEKE Projects\AI Coach\AI识别\AI_Fitness_V10.0.0 - 动作优化\配置文件\算法配置_侧平举.md -->

# 算法配置：侧平举

## 1. 基本信息
- **动作ID**：`lateral_raise`
- **动作名称**：侧平举
- **版本**：V1.0
- **描述**：检测侧平举过程中的抬肘高度与耸肩代偿。

## 2. 全局逻辑控制
- **优先级排序**：`升序` —— P1 > P2。
- **同时触发**：`互斥` —— 同时触发仅显示优先级最高的纠错交互。
- **优先级压制**：`开启` —— 当 P1 (抬肘高度) 触发时，强制忽略 P2 (耸肩) 的错误显示。
- **优先级挤占**：`关闭` —— 纠错中，另一种纠错不可挤占（无论优先级），直到上一个纠错解除。
- **纠错交互触发频率**：`2` —— 每2次错误触发纠错交互。

## 3. 虚拟计算点
我们需要定义一些骨骼模型中不存在的几何中心点，用于后续计算：
- **肩部中点**：
   - 算法：`中点`
   - 输入：左肩, 右肩
- **左肩水平延伸点**：
   - 算法：`水平延伸`
   - 输入：左肩
   - 长度参考：左肩 -> 左肘
   - 方向：-1.0 (向外)
- **右肩水平延伸点**：
   - 算法：`水平延伸`
   - 输入：右肩
   - 长度参考：右肩 -> 右肘
   - 方向：1.0 (向外)

## 4. 动态基准
我们需要采集用户的身体数据作为参考基准：
- **变量名**：`肩部基准高度`
- **采集源**：`点对距离` —— 肩部中点 到 鼻子(0) 的垂直距离。
- **采集策略**：`智能基准校准`
  - 激活状态：`准备`
  - 阻尼系数：`0.05`
  - 衰减系数：`0.9995`

## 5. 状态机配置
定义动作的生命周期流转：
- **准备**：
  - 说明：双臂自然下垂，动作就绪状态。
  - 逻辑：系统初始化或从复位状态判定稳定后进入。
  - 指标：`复位状态停留时长`
  - 阈值：`> 0.5s`
- **向心 (举起)**：
  - 指标：`大臂垂直角` (任一侧)
  - 阈值：`> 30°`
- **复位**：
  - 指标：`大臂垂直角` (双侧)
  - 阈值：`< 20°`
- **僵尸熔断**：
  - 目的：防止用户卡在举起状态。
  - 条件：停留时长 `> 5.0秒` *且* 大臂垂直角 `< 30°`。
  - 动作：强制重置为 `准备` 状态。

## 6. 错误标准配置

### 错误项 A：抬肘高度不足
- **ID**：`range`
- **优先级**：`P1`
- **算法类型**：`垂直角度`
- **核心逻辑**：
  - 测量：大臂(肩-肘)与垂直线的夹角
  - 阈值：`> 80°` (接近水平)
  - 容忍度：`严格 85° / 标准 80° / 宽松 70°`
  - 时序防抖：`3帧`
  - 单双侧：`任一侧` (任一侧未达标即触发“幅度不足”)
  - 
- **判定模式**：`达成即过`
  - 逻辑：动作过程中只要有一次抬高到标准角度，即判合格。

### 错误项 B：耸肩
- **ID**：`shrug`
- **优先级**：`P2`
- **算法类型**：`动态垂直压缩率`
- **核心逻辑**：
  - 测量：`肩部中点` 到 `鼻子` 的垂直距离
  - 基准：`肩部基准高度`
  - 阈值：`最小 0.8` (距离缩短至 80% 以内，即压缩 > 20%)
  - 容忍度：`严格 0.85 / 标准 0.8 / 宽松 0.75`
  - 时序防抖：`5帧`
  - 单双侧：`整体` (基于肩部中点计算)
- **判定模式**：`一票否决`
  - 逻辑：全程只要出现耸肩，即判不合格。
- **纠错区间**：
  - 约束指标：`大臂垂直角`
  - 约束阈值：`> 45°` (仅在手臂抬起时检测耸肩)

## 7. 纠错交互配置

### 7.1 抬肘高度反馈
- **绑定条件**：`range`
- **状态：正确**
  - 左目标点：
    - 类型：`对勾`
    - 位置：`左肩水平延伸点`
    - 样式：绿色
  - 右目标点：
    - 类型：`对勾`
    - 位置：`右肩水平延伸点`
    - 样式：绿色
  - 提示词：
    - 内容：完美动作！
    - 样式：绿色
- **状态：错误**
  - 左肘：
    - 类型：`圆点`
    - 位置：`左肘`
    - 样式：红色、实心
  - 右肘：
    - 类型：`圆点`
    - 位置：`右肘`
    - 样式：红色、实心
  - 左目标点：
    - 类型：`圆点`
    - 位置：`左肩水平延伸点`
    - 样式：红色、空心
  - 右目标点：
    - 类型：`圆点`
    - 位置：`右肩水平延伸点`
    - 样式：红色、空心
  - 左目标线：
    - 类型：`目标线`
    - 定义：`左肩` -> `左肩水平延伸点`
    - 样式：红色、虚线
  - 右目标线：
    - 类型：`目标线`
    - 定义：`右肩` -> `右肩水平延伸点`
    - 样式：红色、虚线
  - 左引导：
    - 类型：`箭头`
    - 定义：终点 `左肩水平延伸点`
    - 方向：垂直向上
    - 样式：红色
    - 动效：`弹性`
  - 右引导：
    - 类型：`箭头`
    - 定义：终点 `右肩水平延伸点`
    - 方向：垂直向上
    - 样式：红色
    - 动效：`弹性`
  - 纠错提示：
    - 内容：肘抬至与肩等高效果更好！
    - 样式：红色

### 7.2 耸肩反馈
- **绑定条件**：`shrug`
- **状态：错误**
  - 左肩引导：
    - 类型：`箭头`
    - 定义：终点 `左肩`，方向 `垂直向下`
    - 样式：红色
    - 动效：`弹性`
  - 右肩引导：
    - 类型：`箭头`
    - 定义：终点 `右肩`，方向 `垂直向下`
    - 样式：红色
    - 动效：`弹性`
  - 纠错提示：
    - 内容：沉肩，不要耸肩！
    - 样式：红色