# AI推荐配置
> 定义：AI推荐引擎的参数化配置中心，采用 JSON 结构化定义，支持运营动态下发。
> 设计原则：基准值 + 修正系数 = 最终参数。

## 1. 策略矩阵配置
> **数据结构**：`Map<Goal, Map<Level, StrategyConfig>>`
> **用途**：定义不同目标和等级下的基准训练参数。

### 配置模型
```json
{
  "goal": "增肌 | 力量 | 减脂 | ...",
  "level_group": ["L1", "L2"] | "All",
  "params": {
    "sets": 3,              // 动作组数 (组)
    "rest_interval": 60,    // 组间休息 (s)
    "intensity": 0.65,      // 训练强度 (%1RM)
    "target_rpe": 7.0,      // 目标RPE (1-10)
    "loop_mode": "常规组",   // 循环模式
    "load_strategy": "推荐", // 负荷策略
    "difficulty_strategy": "标准" // 难度策略引用
  }
}
```

### 默认配置表
| 目标 (Key) | 等级分组 (Key) | 组数 | 休息(s) | 强度 | RPE | 循环模式 | 负荷策略 | 难度策略 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **增肌** | [L1, L2] | 3 | 60 | 0.65 | 7.0 | 常规组 | 推荐 | 标准 |
| **增肌** | [L3, L4] | 4 | 90 | 0.75 | 8.0 | 常规组 | 递增 | 进阶 |
| **增肌** | [L5] | 5 | 90 | 0.80 | 9.0 | 常规组 | 递增 | 挑战 |
| **力量** | [L1, L2] | 3 | 90 | 0.75 | 7.0 | 常规组 | 恒定 | 标准 |
| **力量** | [L3, L4] | 5 | 120 | 0.85 | 9.0 | 常规组 | 恒定 | 进阶 |
| **力量** | [L5] | 5 | 180 | 0.90 | 9.5 | 常规组 | 波浪 | 挑战 |
| **减脂** | [L1, L2] | 3 | 30 | 0.55 | 6.0 | 循环组 | 计时 | 保守 |
| **减脂** | [L3, L4, L5]| 4 | 30 | 0.65 | 8.0 | 循环组 | 计时 | 标准 |
| **耐力** | All | 3 | 30 | 0.40 | 7.0 | 超级组 | 计时 | 标准 |

## 2. 难度策略配置
> **数据结构**：`Map<StrategyName, DifficultyConfig>`
> **用途**：定义动作筛选时的难度兼容范围和概率权重。

### 配置模型 (Schema)
```json
{
  "strategy_name": "标准",
  "range_offset": [-1, 1], // 兼容范围偏移量 [min, max]，基于当前用户等级 Level
  "distribution": {        // 概率分布权重
    "0": 60,               // Level (同级)
    "-1": 20,              // Level-1 (降一级)
    "1": 20                // Level+1 (升一级)
  }
}
```

### 默认配置表
| 策略名称 (Key) | 范围偏移 | 概率分布 (Offset: Weight) | 说明 |
| :--- | :--- | :--- | :--- |
| **保守** | [L1, 0] | {0: 80, -1: 20} | 稳健为主，允许降级，不许升级 |
| **标准** | [-1, 1] | {0: 60, -1: 20, 1: 20} | 兼顾复习与挑战 |
| **进阶** | [0, 1] | {0: 50, 1: 50} | 增加高难度动作比例 |
| **挑战** | [0, 2] | {0: 40, 1: 40, 2: 20} | 允许跨两级挑战 |

## 3. 风格策略配置
> **数据结构**：`Map<StyleName, StyleModifier>`
> **用途**：定义用户偏好对筛选逻辑的修正规则。

### 配置模型
```json
{
  "style_name": "激进型",
  "strategy_override": {   // 策略参数覆盖 (可选)
    "difficulty_strategy": "进阶" 
  },
  "weight_bonus": {        // 动作筛选加分 (可选)
    "attribute": "动作功率", // 目标属性
    "value": "爆发",        // 目标值
    "score": 20            // 加分值
  }
}
```

### 默认配置表
| 风格名称 (Key) | 策略覆盖 | 筛选加分规则 |
| :--- | :--- | :--- |
| **传统型** | - | 属性=`动作构造`, 值=`复合动作`, 分=+20 |
| **多变型** | `loop_mode`="超级组" | 属性=`新鲜度`, 值=`True`, 分=+20 |
| **激进型** | `difficulty_strategy`="进阶" | 属性=`动作功率`, 值=`爆发`, 分=+20 |

## 4. 课程模式配比
> **数据结构**：`Map<PatternName, PatternRecipe>`
> **用途**：定义单节课的动作模式骨架。

### 配置模型
```json
{
  "pattern_name": "推力日",
  "skeleton": [ // 核心骨架 (占容量大头)
    {"mode": "水平推", "ratio": 0.4},
    {"mode": "垂直推", "ratio": 0.4}
  ],
  "filler": [   // 辅助填充 (占容量小头)
    {"muscle": "肱三头肌", "ratio": 0.1},
    {"muscle": "三角肌前束", "ratio": 0.1}
  ]
}
```

### 默认配置表
| 模式名称 (键) | 核心骨架 | 辅助填充 |
| :--- | :--- | :--- |
| **推力日** | 水平推(0.4), 垂直推(0.4) | 肱三头肌(0.1), 肩部(0.1) |
| **拉力日** | 垂直拉(0.4), 水平拉(0.4) | 肱二头肌(0.1), 三角肌后束(0.1) |
| **腿部日** | 膝主导(0.4), 髋主导(0.4) | 小腿(0.1), 腹直肌(0.1) |
| **上肢日** | 水平推(0.2), 水平拉(0.2), 垂直推(0.2), 垂直拉(0.2) | 肱二头肌(0.1), 肱三头肌(0.1) |
| **下肢日** | 膝主导(0.4), 髋主导(0.4) | 单腿(0.1), 核心(0.1) |
| **全身循环** | 上肢推(0.2), 上肢拉(0.2), 下肢蹲(0.2), 下肢铰链(0.2), 核心(0.2) | - |
| **HIIT燃脂** | 全身爆发(0.4), 心肺动作(0.4), 核心稳定(0.2) | - |

## 5. 疲劳干预阈值
> **数据结构**：`List<FatigueRule>`
> **用途**：定义不同疲劳状态下的参数修正规则。

### 配置模型
```json
{
  "range": [30, 54],       // 状态值区间 [min, max]
  "status_label": "疲劳",   // 状态标签
  "modifiers": {           // 参数修正系数
    "intensity": 0.8,      // 强度系数
    "volume": 0.8          // 容量系数
  },
  "constraints": {         // 强制约束
    "exclude_impact": "高冲击" // 剔除高冲击动作
  }
}
```

### 默认配置表
| 状态值区间 | 标签 | 强度系数 | 容量系数 | 强制约束 |
| :--- | :--- | :--- | :--- | :--- |
| **[85, 100]** | 满状态 | 1.0 | 1.0 | - |
| **[55, 84]** | 恢复中 | 0.9 | 1.0 | - |
| **[30, 54]** | 疲劳 | 0.8 | 0.8 | 剔除高冲击 |
| **[0, 29]** | 力竭 | - | - | 强制切换为“主动恢复”课程 |