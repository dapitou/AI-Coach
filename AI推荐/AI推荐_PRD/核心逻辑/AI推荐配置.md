# AI推荐配置
> 定义：AI推荐引擎的参数化配置中心，采用分层架构设计，支持运营动态下发。
> 架构：基准层 (标准) -> 适配层 (修正) -> 执行层 (规则)

## 一、 基准层
> 作用：定义不同目标和等级下的标准训练参数与结构。

### 1.1 策略矩阵配置
> **数据结构**：`Map<计划功能目标, Map<运动等级, 环节参数配置>>`
> **用途**：定义核心训练参数的基准值。

### 配置模型
```json
{
  "计划功能目标": "增肌 | 力量 | 减脂 | ...", // 来源：《计划属性》.计划功能目标
  "运动等级分组": ["L1", "L2"] | "All",     // 来源：《运动档案》.运动等级
  "环节参数": {
    "动作组数": 3,           // 来源：《环节属性》.动作组数
    "动作间歇": 60,          // 来源：《环节属性》.休息配置.动作间歇
    "训练强度": 0.65,        // 来源：《环节属性》.训练强度
    "目标RPE": 7.0,          // 来源：《环节属性》.目标RPE
    "循环模式": "常规组",     // 来源：《环节属性》.循环模式
    "负荷策略": "推荐",       // 来源：《环节属性》.负荷策略
    "难度策略": "标准"        // 来源：《环节属性》.难度策略
  }
}
```

### 默认配置表
| 计划功能目标 | 运动等级分组| 动作组数 | 动作间歇(s) | 训练强度 | 目标RPE | 循环模式 | 负荷策略 | 难度策略 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **增肌** | [L1, L2] | 3 | 60 | 0.65 | 7.0 | 常规组 | 推荐 | 标准 |
| **增肌** | [L3, L4] | 4 | 90 | 0.75 | 8.0 | 常规组 | 递增 | 进阶 |
| **增肌** | [L5] | 5 | 90 | 0.80 | 9.0 | 常规组 | 递增 | 挑战 |
| **力量** | [L1, L2] | 3 | 90 | 0.75 | 7.0 | 常规组 | 恒定 | 标准 |
| **力量** | [L3, L4] | 5 | 120 | 0.85 | 9.0 | 常规组 | 恒定 | 进阶 |
| **力量** | [L5] | 5 | 180 | 0.90 | 9.5 | 常规组 | 波浪 | 挑战 |
| **减脂** | [L1, L2] | 3 | 30 | 0.55 | 6.0 | 循环组 | 计时 | 保守 |
| **减脂** | [L3, L4, L5]| 4 | 30 | 0.65 | 8.0 | 循环组 | 计时 | 标准 |
| **耐力** | All | 3 | 30 | 0.40 | 7.0 | 超级组 | 计时 | 标准 |

### 1.2 课程模式配比
> **数据结构**：`映射<模式名称, 模式配方>`
> **用途**：定义单节课的动作模式骨架。

### 配置模型
```json
{
  "课程模式": "推力日",
  "核心骨架": [ // 占容量大头
    {"动作模式": "水平推", "容量占比": 0.4},
    {"动作模式": "垂直推", "容量占比": 0.4}
  ],
  "辅助填充": [ // 占容量小头
    {"主动肌": "肱三头肌", "容量占比": 0.1},
    {"主动肌": "三角肌前束", "容量占比": 0.1}
  ]
}
```

### 默认配置表
| 模式名称 (键) | 核心骨架 | 辅助填充 |
| :--- | :--- | :--- |
| **推力日** | 水平推(0.4), 垂直推(0.4) | 肱三头肌(0.1), 肩部(0.1) |
| **拉力日** | 垂直拉(0.4), 水平拉(0.4) | 肱二头肌(0.1), 三角肌后束(0.1) |
| **腿部日** | 膝主导(0.4), 髋主导(0.4) | 小腿(0.1), 腹直肌(0.1) |
| **上肢日** | 水平推(0.2), 水平拉(0.2), 垂直推(0.2), 垂直拉(0.2) | 肱二头肌(0.1), 肱三头肌(0.1) |
| **下肢日** | 膝主导(0.4), 髋主导(0.4) | 单腿(0.1), 核心(0.1) |
| **全身循环** | 上肢推(0.2), 上肢拉(0.2), 下肢蹲(0.2), 下肢铰链(0.2), 核心(0.2) | - |
| **HIIT燃脂** | 全身爆发(0.4), 心肺动作(0.4), 核心稳定(0.2) | - |

### 1.3 环节时长分配配置
> **数据结构**：Map<环节类型, 占比范围>
> **用途**：定义各环节在总时长中的占比范围。

### 默认配置表
| 环节类型 | 最小占比 | 最大占比 | 说明 |
| :--- | :--- | :--- | :--- |
| **热身** | 0.10 | 0.15 | 至少10%，至多15% |
| **主训** | 0.70 | 0.80 | 核心训练部分 |
| **放松** | 0.10 | 0.15 | 至少10%，至多15% |

## 二、 适配层
> 作用：定义如何根据用户的个性化状态（等级、偏好、疲劳）修正基准参数。

### 2.1 难度策略配置
> **数据结构**：数据结构：Map<负荷策略, 组序列>
> **用途**：定义动作筛选时的难度兼容范围。

### 配置模型 (Schema)
```json
{
  "负荷策略": "递增", // 来源：《环节属性》.负荷策略
  "组序列": [
    {"组序号": 1, "负荷系数": 0.85, "次数增量": 2}, // 定义：第几组，强度/重量系数，次数调整值
    {"组序号": 2, "负荷系数": 0.90, "次数增量": 1},
    {"组序号": 3, "负荷系数": 1.00, "次数增量": 0}]
}
```

### 默认配置表
| 策略名称 (Key) | 范围偏移 | 概率分布 (Offset: Weight) | 说明 |
| :--- | :--- | :--- | :--- |
| **保守** | [L1, 0] | {0: 80, -1: 20} | 稳健为主，允许降级，不许升级 |
| **标准** | [-1, 1] | {0: 60, -1: 20, 1: 20} | 兼顾复习与挑战 |
| **进阶** | [0, 1] | {0: 50, 1: 50} | 增加高难度动作比例 |
| **挑战** | [0, 2] | {0: 40, 1: 40, 2: 20} | 允许跨两级挑战 |

### 2.2 风格策略配置
> **数据结构**：Map<喜欢的训练风格, 风格修正配置>
> **用途**：定义用户偏好对筛选逻辑的修正。

### 配置模型
```json
{
  "喜欢的训练风格": "激进型", // 来源：《运动档案》.喜欢的训练风格
  "策略覆盖": {             // 定义：覆盖基准层的策略参数
  "难度策略": "进阶"       // 来源：《环节属性》.难度策略
  },
  "筛选加分": {             // 定义：动作筛选时的额外加分规则
  "目标属性": "动作功率",  // 来源：《动作属性》.属性名 (如：动作功率、动作构造)
  "目标值": "爆发",        // 来源：《动作属性》.属性值
  "分值": 20              // 定义：加分权重
  }
}
```

### 默认配置表
| 风格名称 | 策略覆盖 | 筛选加分规则 |
| :--- | :--- | :--- |
| **传统型** | - | 属性=`动作构造`, 值=`复合动作`, 分=+20 |
| **多变型** | `循环模式`="超级组" | 属性=`新鲜度`, 值=`True`, 分=+20 |
| **激进型** | `难度策略`="进阶" | 属性=`动作功率`, 值=`爆发`, 分=+20 |

### 2.3 疲劳干预阈值
> **数据结构**：List<疲劳规则>
> **用途**：定义不同疲劳状态下的参数修正。

### 配置模型
```json
{
  "状态值区间": [30, 54],   // 来源：《疲劳管理逻辑》.部位状态值 [min, max]
  "状态标签": "疲劳",       // 定义：状态显示名称
  "参数修正": {            // 定义：基准参数的乘数系数
  "训练强度": 0.8,       // 来源：《环节属性》.训练强度
  "动作组数": 0.8        // 来源：《环节属性》.动作组数
  },
  "强制约束": {            // 定义：硬性过滤条件
  "剔除冲击等级": "高冲击" // 来源：《动作属性》.冲击等级
  }
}
```

### 默认配置表
| 状态值区间 | 标签 | 强度系数 | 容量系数 | 强制约束 |
| :--- | :--- | :--- | :--- | :--- |
| **[85, 100]** | 满状态 | 1.0 | 1.0 | - |
| **[55, 84]** | 恢复中 | 0.9 | 1.0 | - |
| **[30, 54]** | 疲劳 | 0.8 | 0.8 | 剔除高冲击 |
| **[0, 29]** | 力竭 | - | - | 强制切换为“主动恢复”课程 |

### 2.4 平台期干预配置 [新增]
> **用途**：定义当识别到用户进步停滞时的自动干预策略。

| 触发条件 | 策略变更 | 说明 |
| :--- | :--- | :--- |
| **连续3次负荷未提升** | `负荷策略` -> "波浪" | 通过波动强度打破适应 |
| **连续5次负荷未提升** | `动作组数` -> *1.2 | 增加容量积累代谢压力 |
| **连续2次RPE > 9** | `负荷策略` -> "减载" | 可能是过度训练，强制减载 |

## 三、 执行层
> 作用：定义微观层面的算法执行规则与逻辑。

### 3.1 动作筛选规则配置
> **数据结构**：List<筛选规则>
> **用途**：定义动作筛选时的加分与扣分规则。

### 默认配置表
| 规则名称 | 类型 | 分值 | 条件说明 |
| :--- | :--- | :--- | :--- |
| **核心匹配** | 加分 | +100 | 主要部位匹配且模式符合骨架 |
| **风格契合** | 加分 | +20 | 符合用户风格偏好 |
| **难度适宜** | 加分 | +30 | 符合难度策略 |
| **新鲜度** | 加分 | +40 | 过去7天未训练 |
| **高效加分** | 加分 | +15 | 复合动作 |
| **体位一致** | 加分 | +20 | 与上一动作体位相同 (减少起卧) |
| **器械一致** | 加分 | +15 | 与上一动作器械相同 (减少调节) |
| **难度偏离** | 扣分 | -50 | 超出难度兼容范围 |
| **疲劳惩罚** | 扣分 | -50 | 辅助肌处于疲劳状态 |
| **厌倦惩罚** | 扣分 | -30 | 连续3次同部位训练出现 |
| **安全风控** | 扣分 | -100 | 大体重且低等级且高冲击 |

### 3.2 结构组装配置
> **数据结构**：`Map<SlotType, AssemblyConfig>`
> **用途**：定义动作填充时的抽取数量与策略。

### 默认配置表
| 槽位类型 | 抽取范围 (Top N) | 抽取策略 | 说明 |
| :--- | :--- | :--- | :--- |
| **核心槽位** | 3 | 权重随机 | 复合动作 |
| **辅助槽位** | 5 | 权重随机 | 孤立动作 |
| **探索槽位** | 10 | 权重随机 | 低频/新动作 |

### 3.3 组间策略配置
> **数据结构**：`Map<StrategyName, SetSequence>`
> **用途**：定义不同负荷策略下的每组参数变化。

### 配置模型
```json
{
  "负荷策略": "递增", // 来源：《环节属性》.负荷策略
  "组序列": [
   {"组序号": 1, "负荷系数": 0.85, "次数增量": 2}, // 定义：第几组，强度/重量系数，次数调整值
   {"组序号": 2, "负荷系数": 0.90, "次数增量": 1},
   {"组序号": 3, "负荷系数": 1.00, "次数增量": 0}]
}
```

### 默认配置表
| 策略名称 | 组序号 | 负荷系数 | 次数增量 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **恒定** | All | 1.0 | 0 | 所有组保持基准负荷 |
| **递增** | 1 | 0.85 | +2 | 正金字塔，重量递增 |
| **递增** | 2 | 0.90 | +1 | - |
| **递增** | 3+ | 1.0 | 0 | - |
| **递减** | 1 | 1.0 | 0 | 倒金字塔，重量递减 |
| **递减** | 2 | 0.90 | +2 | - |
| **递减** | 3+ | 0.80 | +4 | - |
| **波浪** | 1 | 0.80 | +2 | 中强度 |
| **波浪** | 2 | 1.0 | 0 | 高强度 |
| **波浪** | 3 | 0.70 | +4 | 低强度 |
| **波浪** | 4 | 0.90 | +1 | 次高强度 |